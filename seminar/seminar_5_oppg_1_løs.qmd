---
title: "Seminar 5"
subtitle: "Løsning oppgave 1"
author: Derek J. Clark
format:
  html:
    code-fold: true
    self-contained: true
editor: visual
---

## 1a

Konsumentens nyttefunksjon er:

$$
U(t,k)=t^{\frac{1}{2}}k^{\frac{1}{2}}\hspace{1cm}(1)
$$

En indifferenskurve som gir nyttenivå $U_0$ defineres som

$$
U_0=t^{\frac{1}{2}}k^{\frac{1}{2}}\hspace{1cm}(2)
$$

Vi skriver om (2) for å få $k$ på venstre siden (dette skal vi tegne på y-aksen):

$$
k^\frac{1}{2}=\frac{U_0}{t^\frac{1}{2}}\\
\Rightarrow (k^\frac{1}{2})^2=\left(\frac{U_0}{t^\frac{1}{2}}\right)^2\\
\Rightarrow k=\frac{U_0^2}{t} \hspace{1cm} (3)
$$

Vi tegner tre indifferenskurver for nyttenivåene 12, 17 og 20.8

```{r}
#| warning: false
rm(list = ls())

suppressPackageStartupMessages(library(tidyverse))


# vi lager oss noen tall for t-variabelen

t <- seq(0, 24, by = .1)

# gjør om til data frame

df <- data.frame(t)

#lag aksen for tegningen

axes_1 <- ggplot(df, aes())+
  labs(x="Fritid (t)", y="Konsum (k)")+
  theme(axis.title = element_text(size = 20),
        plot.title = element_text(size = 20),
        panel.background = element_blank(), # hvit bakgrunn
        axis.line = element_line(colour = "black"))+ # sett inn akselinjer
  scale_x_continuous(limits = c(0, 24), expand = c(0, 0))+
  scale_y_continuous(limits = c(0, 100), expand = c(0, 0)) # begrense aksene
# og sikre at akselinjene møttes i (0,0).

# vi angir noen indifferenskurver

I_0 <- function(t) (12^2)/t # nyttenivå 12
I_1 <- function(t) (17^2)/t
I_2 <- function(t) (20.8^2)/t

figur_1 <- axes_1 + labs(title="Indifferenskurver")+
  stat_function(df,
        fun=I_0,
        mapping = aes()
        ) +
  stat_function(df,
                fun=I_1,
                mapping = aes()
  ) +
  stat_function(df,
                fun=I_2,
                mapping = aes()
  )+
  annotate("text",x=1,y=90, label=expression(u[0]))+
  annotate("text",x=2.8,y=90, label=expression(u[1]))+
  annotate("text",x=5.5,y=90, label=expression(u[2]))

figur_1
```

## 1b

MSB er helningen til indifferenskurven, og måler hvor villig konsumenten er til å ofre konsum for en ekstra time med fritid.

## 1c

Indifferenskurven er gitt ved (3). Gitt at MSB er helningen til indifferenskurven kan vi derivere dette uttrykket med hensyn på t for å finne dette:

$$
\frac{dk}{dt}=-\frac{U_0^2}{t^2} \hspace{1cm} (4)
$$

Fra (2) kan vi skrive

$$
U_0^2=(t^{\frac{1}{2}}k^{\frac{1}{2}})^2=tk \hspace{1cm}(5)
$$

Sett (5) inn i (4)

$$
\frac{dk}{dt}=-\frac{tk}{t^2}=-\frac{k}{t} \hspace{1cm} (6)
$$

MSB er helningen til indifferenskurven som er uttrykket gitt i (6) som ønsket.

## 1d

```{r}
#| warning: false

bud_2 <- function(t) 2*(24-t)
bud_3 <- function(t) 3*(24-t)


figur_2 <- axes_1 + labs(title="Konsumentens budsjett")+
  stat_function(df,
        fun=bud_2,
        mapping = aes()
        ) +
  stat_function(df,
                fun=bud_3,
                mapping = aes()
  ) +
  annotate("text",x=1,y=50, label="w=2")+
  annotate("text",x=1,y=75, label="w=3")

figur_2
```

## 1e

La oss kombinere figurene

```{r}
#| warning: false

figur_3 <- axes_1 + labs(title="Konsumentens tilpasning")+
  stat_function(df,
        fun=I_0,
        mapping = aes()
        ) +
  stat_function(df,
                fun=I_1,
                mapping = aes()
  ) +
  stat_function(df,
                fun=I_2,
                mapping = aes()
  )+
  annotate("text",x=1,y=90, label=expression(u[0]))+
  annotate("text",x=2.8,y=90, label=expression(u[1]))+
  annotate("text",x=5.5,y=90, label=expression(u[2]))+
  stat_function(df,
        fun=bud_2,
        mapping = aes()
        ) +
  stat_function(df,
                fun=bud_3,
                mapping = aes()
  ) +
  annotate("text",x=1,y=50, label="w=2")+
  annotate("text",x=1,y=75, label="w=3")

figur_3

```

Tilpasningen for begge lønnsnivå befinner seg hvor en indifferenskurve tangerer budsjettbetingelsen.

## 1f

MTB er helningen på budsjettbetingelsen

$$
k=w(24-t)  \hspace{1cm} (7)
$$

dvs $\frac{dk}{dt}=MTB = -w$.

## 1g

Ved å sette MTB lik MSB fra (6) får vi

$$
w=\frac{k}{t}  \hspace{1cm} (8)
$$

Vi vet at konsumenten tilpasser seg på budsjettlinjen i (7). Fra (8) kan vi skrive $k=tw$ som vi setter inn i (7):

$$
tw=w(24-t) \Rightarrow t=24-t \Rightarrow t=12   \hspace{1cm} (9)
$$

Denne konsumenten har $t^{*}=12$ timer med fritid uansett lønna! (Vi bruker en \* for å vise optimale mengder). Optimal konsum blir da $k^{*}=12w$.

Da kan vi sette de optimale tilpasningene inn i figuren

```{r}
#| warning: false

figur_4 <- figur_3+
  geom_segment(x=0,y=24, xend=12, yend=24, 
               linetype ="dashed", color="red")+
  geom_segment(x=12,y=0, xend=12, yend=24, 
               linetype ="dashed", color="red")+
  geom_segment(x=0,y=36, xend=12, yend=36, 
               linetype ="dashed")+
  geom_segment(x=12,y=24, xend=12, yend=36, 
               linetype ="dashed")
  
figur_4

```
